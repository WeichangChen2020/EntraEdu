<!-- 试题单元列表 -->
<!DOCTYPE html>
<html>
<head>
    <title>试题列表</title>
    <include file="./Public/html/_head.html"/>
    <style>
    #unit{display:none;}
</style>
</head>

<body ontouchstart>

    <header class='demos-header'>
        <h1 class="demos-title">试题列表</h1>
    </header>

    <div class="bd">
        <div class="weui_cells_title">请选择章节</div>
        <div class="weui_cells weui_cells_checkbox">
            <volist name="chapterList" id="chapterList" key="k" empty="没有查到信息">
                <label class="weui_cell weui_check_label" for="{$k}">
                    <div class="weui_cell_hd">
                        <input type="checkbox" class="weui_check" name="checkbox1" id="{$k}">
                        <i class="weui_icon_checked"></i>
                        <div id="unit">{$k}</div>
                    </div>
                    <div class="weui_cell_bd weui_cell_primary">
                        <p>第{$k}章 {$chapterList['chapter']}</p>
                    </div>
                </label>
            </volist>
        </div>
    </div>
    <div class="weui_btn_area">
        <a class="weui_btn weui_btn_primary" href="javascript:;" id="submit">确定</a>
    </div>
</body>
</html>
<include file="./Public/html/_foot.html"/>
<script>
    $('#submit').click(function(){
        var unit = '';
        var count= 0;
        var chapList = {$chapterList};

        $(":checked").each(function(){
            unit += $(this).siblings('#unit').html();
            unit += '_'
        });

        if(unit === '') {
            $.toptip('你还没有选择章节','warning');
            return false;
        }
        //获取题目总数用作规定上限
        var url = "{:U('Teacher/homework_assign_zg')}";
        $.post(url, {'unit':unit,}, function(res){
            count = res;
        });

        $.modal({
            title: "提示",
            text: "你需要自动随机出题吗？",
            buttons: [
            { 
                text: "是", onClick: function(){ 
                    $.prompt("1-"+count, "输入题目数量", function(text) {
                        if(isNaN(parseInt(text)))
                            $.toptip('题目内容非法','warning');
                        else if(parseInt(text)<1 || parseInt(text)>count)
                            $.toptip('题目数量非法','warning');
                        else
                            window.location.href="homework_assign_zg2/unit/"+unit+"/number/"+text;
                    }, function() {
                        //取消操作
                    });  
                } 
            },
            { 
                text: "否", onClick: function(){ 
                    window.location.href="homework_assign_zg2/unit/"+unit;
                } 
            },
            { 
                text: "取消", 
                className: "default"
            },
            ]
        });
    });
</script>
